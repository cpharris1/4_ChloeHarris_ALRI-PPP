#:kivy 1.0


#:import Factory kivy.factory.Factory
#:import time time


<biozPopup>:
    Label:
        text: 'Display R graph here'
    Label:
        text: 'Display X graph here'

<audioPopup>:
    Label:
        text: 'Display FFT here'

ScreenManager:
    id: screen_manager
    #transition: FadeTransition()
    MenuScreen:
        id: menu_screen
        name: 'MenuScreen'
        manager: 'screen_manager'
    BiozScreen1:
        id: bioz_1
        name: 'BiozScreen1'
        manager: 'screen_manager'
    AudioScreen1: 
        id: audio_1
        name: 'AudioScreen1'
        manager: 'screen_manager'

<BiozScreen1>:
    name: 'BiozScreen1'
    GridLayout:
        cols: 1
        rows: 3    
        canvas.before:
            Color:
                rgb: [1, 1, 1]
            Rectangle:
                # self here refers to the widget i.e FloatLayout
                pos: self.pos
                size: self.size
        #size_hint_y: None
        GridLayout:
            size_hint_y: 0.1
            minimum_height: 20
            cols: 3
            rows: 1
            Button:
                background_color: ("#C00000")
                text: 'Menu'
                on_press: 
                    print(app.root.get_screen('MenuScreen').ids.patient_id.text)
                on_release:
                    app.root.current = 'MenuScreen'
                    print(app.root.get_screen('MenuScreen').ids.patient_id.text)
            Label:
                text: "Capture BioZ Data"
                color: 0, 0, 0                    
            Label:
                text:""
        GridLayout:
            size_hint_y: 0.1
            minimum_height: 20
            #size_hint_y: None
            #height: self.minimum_height

            cols: 3
            rows: 1
            #padding: [10, 10, 10, 10]
            spacing: 5
            GridLayout:
                cols: 2
                rows: 1
                #padding: [L, T, R, B]
                padding: [0, 0, 3, 0]
                Label:
                    text: "Clinician ID: "
                    color: 0, 0, 0
                Label:
                    id: "clid"
                    text: "0"
                    color: 0, 0, 0
                    
            GridLayout:
                cols: 2
                rows: 1
                #padding: [L, T, R, B]
                padding: [0, 0, 3, 0]
                Label:
                    text: "Patient ID: "
                    color: 0, 0, 0
                Label:
                    id: "ptid"
                    text: "0"
                    color: 0, 0, 0
            Label:
                text: ""
                color: 0, 0, 0


<AudioScreen1>:
    name: 'AudioScreen1'
    Button:
        background_color: ("#C00000")
        text: 'Menu'
        on_release:
            app.root.current = 'MenuScreen'

<MenuScreen>:
    name: 'MenuScreen'
    GridLayout:
        cols: 1
        rows: 3    
        canvas.before:
            Color:
                rgb: [1, 1, 1]
            Rectangle:
                # self here refers to the widget i.e FloatLayout
                pos: self.pos
                size: self.size
        #size_hint_y: None

        GridLayout:
            size_hint_y: 0.1
            minimum_height: 20
            cols: 3
            rows: 1
            Label: 
                text: "ALRI Home"
                color: 0, 0, 0                    

        GridLayout:
            size_hint_y: 0.1
            minimum_height: 20
            #size_hint_y: None
            #height: self.minimum_height

            cols: 3
            rows: 1
            #padding: [10, 10, 10, 10]
            spacing: 5
            GridLayout:
                cols: 2
                rows: 1
                #padding: [L, T, R, B]
                padding: [0, 0, 3, 0]
                Label:
                    text: "Clinician ID: "
                    color: 0, 0, 0
                Spinner:
                    id: clinician_id
                    text: '1'
                    values: '1', '2', '3', '4', '5'
                    on_text:
                        app.cl_id = root.ids.clinician_id.text
                        print(app.cl_id)
                        print("The clinician_id spinner has text {}".format(root.ids.clinician_id.text))
            GridLayout:
                cols: 2
                rows: 1
                #padding: [L, T, R, B]
                padding: [0, 0, 3, 0]
                Label:
                    text: "Patient ID: "
                    color: 0, 0, 0
                Spinner:
                    id: patient_id
                    text: '1'
                    values: '1', '2', '3', '4', '5'
                    on_text:
                        #root.spinner2_clicked(patient_id.text)
                        app.pt_id = root.ids.clinician_id.text
                        print(app.pt_id)
                        print("The patient_id spinner has text {}".format(root.ids.patient_id.text))
            Label:
                text: ""
                color: 0, 0, 0
            # Label:
            #     text: "Start Date/Time: "
            #     color: 0, 0, 0
            # GridLayout:
            #     cols: 2
            #     rows:1
            #     Label:
            #         id: time_label
            #         text: app.timestamp
            #         color: 0, 0, 0
            #     MDIconButton:
            #         icon:"refresh"
            #         on_release:
            #             app.timestamp = app.new_timestamp()
            #             root.ids.time_label.text = app.timestamp
            #             print('Generated new time - ' + app.timestamp)



        GridLayout:
            cols: 3
            rows: 2
            size_hint_y: 0.6
            padding: [10, 10, 10, 10]
            spacing: 10
            Button:
                text: 'Capture BioZ'
                background_color: ("#4472C4")
                on_press:
                    #self.color = (1,0,0,1)
                    app.root.current = 'BiozScreen1'

                # on_release:
                #     print("Capturing BIOZ")
                #     app.get_bioz();
                #     #time.sleep(5)
                #     print("BIOZ captured")
                #     self.color = (1,1,1,1)
                #     self.text="Capture BIOZ"

            Button:
                text: 'Capture Audio'
                background_color: ("#C00000")
                on_press:
                    #self.color = (1,0,0,1)
                    app.root.current = 'AudioScreen1'
                #     self.text = "Recording"
                # on_release:
                #     print("Capturing audio")
                #     app.get_audio()
                #     self.color = (1,1,1,1)
                #     self.text = "Capture Audio"

            Button:
                text: 'Capture EGG'
                background_color: ("#385723")
                on_press:
                    self.color = (1,0,0,1)
                    self.text = "Capturing EGG"
                on_release:
                    print("Capturing EGG")
                    # app.get_EGG() NOT IMPLEMENTED YET
                    self.color = (1,1,1,1)
                    self.text = "Capture EGG"
            
            # Audio
            # BoxLayout:
            #     orientation: 'vertical'
            #     padding: [10,10,10,10]
            #     spacing: 10
            
            Button:
                text: 'View BioZ'
                background_color: ("#4472C4")
                on_release:
                    print("Viewing BIOZ")
                    #Factory.biozPopup().open()
                    #app.show_bioz()
                    app.plot_bioz()

            Button:
                background_color: ("#C00000")
                text: 'View Audio'
                on_release:
                    print("Viewing audio")
                    #app.show_audio()
                    app.plot_audio()

            # Audio
            # BoxLayout:
            #     orientation: 'vertical'
            #     padding: [10,10,10,10]
            #     spacing: 10
            
            Button:
                text: 'View EGG'
                background_color: ("#385723")
                on_release:
                    print("Viewing EGG")
                    # app.show_EGG() NOT IMPLEMENTED YET
                    

